/*! angular-pageslide-directive 2016-06-19 */
angular.module("pageslide-directive",[]).directive("pageslide",["$document","$timeout",function(a,b){return{restrict:"EAC",transclude:!1,scope:{psOpen:"=?",psAutoClose:"@",psSide:"@",psSpeed:"@",psClass:"@",psSize:"@",psZindex:"@",psSqueeze:"@",psCloak:"@",psPush:"@",psContainer:"@",psKeyListener:"@",psBodyClass:"@",psClickOutside:"@",onopen:"=",onclose:"="},link:function(c,d,e){function f(a){p&&!n.contains(a.target)&&(p=!1,c.psOpen=!1,c.$apply()),c.psOpen&&(p=!0)}function g(a){if(l.bodyClass){var b=l.className+"-body",c=new RegExp(" "+b+"-closed| "+b+"-open");o.className=o.className.replace(c,""),o.className+=" "+b+"-"+a}}function h(){c.psOpen?"function"==typeof c.onopen&&c.onopen():"function"==typeof c.onclose&&c.onclose()}function i(b,d){if(b&&0!==b.style.width)switch(m.css("display","none"),d.side){case"right":b.style.width="0px",d.squeeze&&(o.style.right="0px"),d.push&&(o.style.right="0px",o.style.left="0px");break;case"left":b.style.width="0px",d.squeeze&&(o.style.left="0px"),d.push&&(o.style.left="0px",o.style.right="0px");break;case"top":b.style.height="0px",d.squeeze&&(o.style.top="0px"),d.push&&(o.style.top="0px",o.style.bottom="0px");break;case"bottom":b.style.height="0px",d.squeeze&&(o.style.bottom="0px"),d.push&&(o.style.bottom="0px",o.style.top="0px")}d.keyListener&&a.off("keydown",k),d.clickOutside&&a.off("click",f),p=!1,g("closed"),c.psOpen=!1}function j(d,e){if(0!==d.style.width){switch(e.side){case"right":d.style.width=e.size,e.squeeze&&(o.style.right=e.size),e.push&&(o.style.right=e.size,o.style.left="-"+e.size);break;case"left":d.style.width=e.size,e.squeeze&&(o.style.left=e.size),e.push&&(o.style.left=e.size,o.style.right="-"+e.size);break;case"top":d.style.height=e.size,e.squeeze&&(o.style.top=e.size),e.push&&(o.style.top=e.size,o.style.bottom="-"+e.size);break;case"bottom":d.style.height=e.size,e.squeeze&&(o.style.bottom=e.size),e.push&&(o.style.bottom=e.size,o.style.top="-"+e.size)}b(function(){m.css("display","block")},1e3*e.speed),c.psOpen=!0,e.keyListener&&a.on("keydown",k),e.clickOutside&&a.on("click",f),g("open")}}function k(a){var d=27,e=a.keyCode||a.which;e===d&&(i(n,l),b(function(){c.$apply()}))}var l={};l.side=c.psSide||"right",l.speed=c.psSpeed||"0.5",l.size=c.psSize||"300px",l.zindex=c.psZindex||1e3,l.className=c.psClass||"ng-pageslide",l.squeeze="true"===c.psSqueeze,l.push="true"===c.psPush,l.container=c.psContainer||!1,l.keyListener="true"===c.psKeyListener,l.bodyClass=c.psBodyClass||!1,l.clickOutside="false"!==c.psClickOutside,d.addClass(l.className);var m,n,o,p=!1;if(o=l.container?document.getElementById(l.container):document.body,(l.squeeze||l.push)&&(o.style.position="absolute",o.style.transitionDuration=l.speed+"s",o.style.webkitTransitionDuration=l.speed+"s",o.style.transitionProperty="top, bottom, left, right"),g("closed"),n=d[0],"div"!==n.tagName.toLowerCase()&&"pageslide"!==n.tagName.toLowerCase())throw new Error("Pageslide can only be applied to <div> or <pageslide> elements");if(0===n.children.length)throw new Error("You need to have content inside the <pageslide>");switch(m=angular.element(n.children),o.appendChild(n),n.style.zIndex=l.zindex,n.style.position=l.container!==!1?"absolute":"fixed",n.style.width=0,n.style.height=0,n.style.transitionDuration=l.speed+"s",n.style.webkitTransitionDuration=l.speed+"s",n.style.transitionProperty="width, height",n.addEventListener("transitionend",h),l.side){case"right":n.style.height=e.psCustomHeight||"100%",n.style.top=e.psCustomTop||"0px",n.style.bottom=e.psCustomBottom||"0px",n.style.right=e.psCustomRight||"0px";break;case"left":n.style.height=e.psCustomHeight||"100%",n.style.top=e.psCustomTop||"0px",n.style.bottom=e.psCustomBottom||"0px",n.style.left=e.psCustomLeft||"0px";break;case"top":n.style.width=e.psCustomWidth||"100%",n.style.left=e.psCustomLeft||"0px",n.style.top=e.psCustomTop||"0px",n.style.right=e.psCustomRight||"0px";break;case"bottom":n.style.width=e.psCustomWidth||"100%",n.style.bottom=e.psCustomBottom||"0px",n.style.left=e.psCustomLeft||"0px",n.style.right=e.psCustomRight||"0px"}c.$watch("psOpen",function(a){a?j(n,l):i(n,l)}),c.$watch("psSize",function(a,b){b!==a&&(l.size=a,c.psOpen&&j(n,l))}),c.$on("$destroy",function(){n.parentNode===o&&(l.clickOutside&&a.off("click",f),o.removeChild(n)),n.removeEventListener("transitionend",h)}),c.psAutoClose&&(c.$on("$locationChangeStart",function(){i(n,l)}),c.$on("$stateChangeStart",function(){i(n,l)}))}}}]);